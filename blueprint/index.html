<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Blueprint Editor (UE5 Replica)</title>
    <!-- Prevent caching during development -->
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
    <meta http-equiv="Pragma" content="no-cache" />
    <meta http-equiv="Expires" content="0" />

    <!-- Google Font (Inter) -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

    <!-- FontAwesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
    
    <!-- Reuse Material Editor styles for base UE5 look, but with customizations for Blueprints -->
    <link rel="stylesheet" href="../public/style.css">
    <style>
        :root {
            --editor-accent: #2c9aff; /* Blueprint blue */
        }
        .menubar { border-top: 2px solid var(--editor-accent); }
        .btn-green-add {
            background: #1e6b1e;
            color: white;
            border: none;
            padding: 4px 12px;
            font-size: 11px;
            border-radius: 2px;
            display: flex;
            align-items: center;
            cursor: pointer;
        }
        .btn-green-add:hover { background: #2a8a2a; }
    </style>
</head>
<body class="theme-dark">
    <div id="app-container">
        <!-- TOP MENU BAR -->
        <div id="menubar" class="menubar">
            <div class="menu-left">
                <img src="../public/assets/icons/ue-logo.svg" alt="UE Logo" class="ue-logo-icon" style="width: 18px; margin: 0 10px;">
                <div class="menu-item" data-menu="file">File</div>
                <div class="menu-item">Edit</div>
                <div class="menu-item">Asset</div>
                <div class="menu-item">View</div>
                <div class="menu-item">Debug</div>
                <div class="menu-item" data-menu="window">Window</div>
                <div class="menu-item">Help</div>
            </div>
            <div class="menu-right">
                <div class="window-controls">
                    <i class="fas fa-minus"></i>
                    <i class="far fa-square"></i>
                    <i class="fas fa-times"></i>
                </div>
            </div>
        </div>

        <!-- TAB BAR -->
        <div id="tabbar" class="tabbar">
            <div class="tab active">
                <i class="fas fa-file-code" style="color: #4a90e2; margin-right: 6px;"></i>
                <span>NewBlueprint*</span>
                <i class="fas fa-times tab-close"></i>
            </div>
            <div class="tab-spacer"></div>
        </div>

        <!-- TOP TOOLBAR -->
        <div id="toolbar" class="panel">
            <div class="group">
                <button id="compile-btn" title="Compile (F7)">
                    <i class="fas fa-hammer"></i> Compile
                </button>
                <button id="save-btn" title="Save (Ctrl+S)">
                    <i class="fas fa-save"></i> Save
                </button>
            </div>
            <div id="play-controls" class="group">
                <button id="play-btn" title="Play (Simulate)">
                    <i class="fas fa-play"></i> Play
                </button>
                <button id="stop-btn" title="Stop Simulation" disabled>
                    <i class="fas fa-stop"></i> Stop
                </button>
            </div>
            <div class="group">
                <button id="undo-btn" title="Undo (Ctrl+Z)"><i class="fas fa-undo"></i></button>
                <button id="redo-btn" title="Redo (Ctrl+Y)"><i class="fas fa-redo"></i></button>
            </div>
            <span id="toolbar-status" class="toolbar-status">Zoom: <span id="zoom-readout">100%</span></span>
            <div style="margin-left: auto;" class="group">
                <button id="help-btn" title="Help (F1)"><i class="fas fa-question-circle"></i> Help</button>
            </div>
        </div>

        <!-- MAIN AREA -->
        <div id="main-content" style="display: flex; flex: 1; overflow: hidden;">
            <!-- LEFT PANEL -->
            <div id="left-panel" class="panel" style="width: 300px; display: flex; flex-direction: column;">
                <div id="components-panel">
                    <div class="panel-header">Components</div>
                    <div class="panel-toolbar">
                        <button class="btn-green-add"><i class="fas fa-plus"></i> Add</button>
                    </div>
                </div>
                <div id="my-blueprint" style="flex: 1; display: flex; flex-direction: column;">
                    <div class="panel-header">My Blueprint</div>
                    <div id="my-blueprint-content" class="panel-content" style="flex: 1;"></div>
                </div>
            </div>

            <div id="resizer-left" class="resizer-vertical"></div>

            <!-- CENTER GRAPH -->
            <div id="graph-editor" class="panel" style="flex: 1; position: relative; overflow: hidden; background: #151515;">
                <canvas id="graph-canvas"></canvas>
                <svg id="graph-svg" style="position: absolute; width: 100%; height: 100%; pointer-events: none;">
                    <g id="wire-group">
                        <path id="ghost-wire" class="wire" style="display: none; stroke: #ccc; stroke-width: 2; fill: none;"></path>
                    </g>
                </svg>
                <div id="nodes-container" style="position: absolute; width: 100%; height: 100%; pointer-events: none;"></div>
                <div id="selection-marquee" style="display: none; border: 1px solid #2c9aff; background: rgba(44, 154, 255, 0.1); position: absolute;"></div>
            </div>

            <div id="resizer-right" class="resizer-vertical"></div>

            <!-- RIGHT PANEL -->
            <div id="right-panel" class="panel" style="width: 300px;">
                <div class="panel-header">Details</div>
                <div id="details-panel" class="panel-content"></div>
            </div>
        </div>

        <!-- BOTTOM PANEL -->
        <div id="resizer-bottom" class="resizer-horizontal"></div>
        <div id="bottom-strip" class="panel" style="height: 200px;">
            <div class="bottom-tabs">
                <div class="bottom-tab active" data-tab="compiler">Compiler Results</div>
                <div class="bottom-tab" data-tab="find">Find Results</div>
            </div>
            <div id="compiler-results" class="panel-content"></div>
            <div id="find-results-container" class="panel-content" style="display: none;"></div>
        </div>
    </div>

    <!-- Modals & Menus -->
    <div id="action-menu" style="display: none; position: absolute; background: #222; border: 1px solid #444; z-index: 1000; width: 250px;">
        <input type="text" id="action-menu-search" placeholder="Search..." style="width: 100%; padding: 8px; background: #1a1a1a; color: white;">
        <div id="action-menu-list"></div>
    </div>
    <div id="context-menu" style="display: none;"></div>

    <!-- Scripts -->
    <script type="module" src="./app.js"></script>
</body>
</html>
